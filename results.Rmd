# Results

```{r, echo=FALSE, include=FALSE}
# libraries
library(dplyr)
library(leaflet)
library(sp)
library(ggmap)
library(maptools)
library(broom)
library(httr)
library(rgdal)
library(ggplot2)
library(tigris)
library(RColorBrewer)
library(ggpubr)
library(ggridges)
library(GGally)
library(RColorBrewer)
library(ggrepel)
library(forcats)
library(tidyr)
library(dplyr)
library(vcd)
library(ggthemes)
# import data
data = read.csv(file='data/clean/combined_dataset.csv')
library(vcd)
library(ggthemes)
```
Home Internet Adoption Map:
```{r, echo=FALSE}
# import map data
nyc_neighborhoods <- readOGR('data/map/NTA_map.geojson')

current <- select(data, c('Borough', 'Neighborhood.Name', 'Home.Broadband.Adoption..'))
names(current)[1] <- 'borough'
names(current)[2] <- 'neighborhood'
names(current)[3] <- 'points'

current$borough_num <- unclass(current$borough)
current$opacity_lvl <- current$points
current$opacity_lvl <- current$opacity_lvl^3

map_data <- geo_join(nyc_neighborhoods, current, "ntaname", "neighborhood")

pal <- colorFactor(palette = 'Set1',
                    unique(map_data@data$boroname))

leaflet(map_data) %>%
  addTiles() %>%
  addPolygons(popup = paste("Neighborhood:", map_data@data$ntaname, "<br>",
                            "Borough:", map_data@data$boroname, "<br>",
                            "Internet Adoption Rate:", paste(map_data@data$points*100, '%', sep=''), "<br>"),
              fillColor = ~pal(map_data@data$boroname),
              fillOpacity = map_data@data$points^3,
              highlightOptions = highlightOptions(weight = 3),
                                  color = "Black",
                                  weight = 1) %>%
  addProviderTiles("CartoDB.Positron") %>%
  addLegend("bottomright", pal = pal, values = ~map_data@data$boroname)
```


Income and Internet Trends:
```{r, echo=FALSE}
current <- select(data, c('Borough',
                          'Per.Capita.Income..in...',
                          'Home.Broadband.Adoption..', 
                          'Residential.Broadband.Choice.Average.by.NTA',
                          'Mobile.Dependent.Households..Percentage.of.Households.' ,
                          'Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in..',
                          'Public.Wi.Fi.in.NYC.Count', 
                          'Mobile.Broadband.Adoption..'))

current$Per.Capita.Income..in... <-
  current$Per.Capita.Income..in.../1000

current$Mobile.Dependent.Households..Percentage.of.Households. <-
  current$Mobile.Dependent.Households..Percentage.of.Households. * 100

current$Mobile.Broadband.Adoption.. <-
  current$Mobile.Broadband.Adoption.. * 100

current$Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in.. <-
  current$Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in.. * 100

current$Home.Broadband.Adoption.. <-
  current$Home.Broadband.Adoption.. * 100


plot1 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Home.Broadband.Adoption..)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black') +
  xlab('Income (in $1000s)') +
  ylab('% Internet Adoption') +
  theme(text = element_text(size = 10)) +
  theme_bw()
  
plot2 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Residential.Broadband.Choice.Average.by.NTA)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black') +
  xlab('Income (in $1000s)') +
  ylab('# of Carriers') +
  theme(text = element_text(size = 10)) +
  theme_bw()

plot3 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Mobile.Dependent.Households..Percentage.of.Households.)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black') +
  xlab('Income (in $1000s)') +
  ylab('% Mobile Dependent') +
  theme(text = element_text(size = 10)) +
  theme_bw()

plot4 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in..)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black')  +
  xlab('Income (in $1000s)') +
  ylab('% High Speed Internet') +
  theme(text = element_text(size = 10)) +
  theme_bw()

plot5 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Public.Wi.Fi.in.NYC.Count)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black') +
  xlab('Income (in $1000s)') +
  ylab('Public WiFi Count') +
  theme(text = element_text(size = 10)) +
  theme_bw()

plot6 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Mobile.Broadband.Adoption..)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black') +
  xlab('Income (in $1000s)') +
  ylab('% Mobile Internt Adoption') +
  theme(text = element_text(size = 10)) +
  theme_bw()

figure <- ggarrange(plot1, plot2, plot3, plot4, plot5, plot6, ncol=3, nrow=2, common.legend = TRUE, legend="bottom")

annotate_figure(figure,
                top = text_grob("Income and Internet Trends", size=20, face = "bold"))
```
In the above graphs we can see a comparison of income levels (by borough) and several internet availability measures. The black line on each graph represents the trend between income and the respective measure of internet. The colors represent the boroughs and each dot is a neighborhood within the borough. 

As we can see from the data, Manhattan seems to be the borough with the highest income. The green dots tend to be further right and away from the other boroughs demonstrating that trend. The rest of the boroughs are relatively close together regarding their income. We see this in looking at the clusters in each graph.

Now, looking at internet trends with regards to internet availability, there are some significant patterns to be aware of. First of all, when looking at the black trend line we can see that they are all positive trends except the top right graph representing mobile dependent households. For the other five comparisons, this signifies that higher incomes are correlated with better internet. Whether it be more public Wi-Fi hot-spots, faster internet, more selection with internet providers, or higher mobile and household internet adoption. As for the top right graph showing the negative trend. This is because mobile dependency is the inverse of better internet coverage. If more households are mobile dpendent it means they do not have internet in their and therefore a lower internet adoption rate. 

Looking at these trends we can see that internet adoption is positively correlated to income level. As the higher the income the more available internet is in each neighborhood.

Significant Trend in The Bronx:
```{r, echo=FALSE}
current = select(data, c('Borough', 'Families.below.poverty.level..', 'Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in..'))

current$Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in.. <-
  current$Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in.. * 100
ggplot(current, aes(x=Families.below.poverty.level.., y=Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in.., col=Borough)) +
  geom_point(size=2) +
  xlab('Families Below Poverty Line') +
  ylab('% Internet availability > 900 Mbps') +
  ggtitle('Poverty Level and Fast Speed Internet') +
  theme_bw()
```
This graph represents families below the poverty line in each neighborhood compared to high speed internet availability. According to the US Census, the poverty line in the United States is annual income below $33,000. As for the y-axis variable, this represents the percentage of blocks in a neighborhood that have access to internet speeds of 900 Mbps or higher. This high speed internet is crucial for businesses operating several internet-dependent pieces of technology at once as well as any household with a large number of connected devices. 

As we can see from the chart The Bronx seems to be isolated from the other boroughs. No neighborhood in The Bronx has complete access to internet speeds greater than 900 Mbps. Also, we see neighborhoods int he Bronx being further right on the graph than neighborhoods in other boroughs. This signifies more families below the poverty line compared to the other boroughs. These two factors again reinforce the idea that economic status and internet adoption are correlated.


```{r}
data = read.csv(file='data/clean/combined_dataset_no_weird.csv')

data_snap <- select(data, c('Borough',
                          'Neighborhood.Name',
                          'Total.Population',
                          'Total.Number.of.Households',
                          'Per.Capita.Income..in...',
                          'Home.Broadband.Adoption..', 
                          'Residential.Broadband.Choice.Average.by.NTA',
                          'Mobile.Dependent.Households..Percentage.of.Households.' ,
                          'Public.Wi.Fi.in.NYC.Count', 
                          'Mobile.Broadband.Adoption..',
                          'English.only.language..',
                          'Language.other.than.English..',
                          'Native.born.in.US..',
                          'Foreign.born..',
                          'Completed.Bachelors.degree.or.higher..',
                          'Median.House.gross.rent..in...',
                          'Median.House.value..in...', 
                          'Owner.occupied.Housing.unit..',
                          'Total.occupied.Housing.unit..',
                          'Renter.occupied.Housing.unit..',
                          'Work.from.Home...Capable',
                          'Work.from.Home...Incapable',
                          'plurality_racial_group'
                          ))
data_snap$Per.Capita.Income..in... <- data_snap$Per.Capita.Income..in.../1000
data_snap$Mobile.Dependent.Households..Percentage.of.Households. <- data_snap$Mobile.Dependent.Households..Percentage.of.Households. * 100
data_snap$Mobile.Broadband.Adoption.. <- data_snap$Mobile.Broadband.Adoption.. * 100
data_snap$Home.Broadband.Adoption.. <- data_snap$Home.Broadband.Adoption.. * 100

```

```{r}

## Do the people in NYC who we are living in rented stays have access to better internet facilities?

# Internet Access Ratings around Rented Stays
iar <- ggplot(data, aes(fill=Borough, x=Residential.Broadband.Choice.Average.by.NTA, y=Renter.occupied.Housing.unit..)) +
    geom_line(aes(color=Borough), alpha=.5, size =8) +
    ggtitle("Internet Access Ratings around Rented Stays") +
    xlab("Region Broadband Rating by NTA") +
    ylab("Rented Housing Units in %") +
    theme_economist() + 
    scale_color_economist() +
    theme(axis.title = element_text(size = 5),
    axis.text = element_text(size = 5))

iar
```
Above plot analyses the broadband effectiveness in and around rented stays. Students, employed or unemployed people need to ensure the rent they pay give them the best facilities that's available in the region. As most of the people are immigrants, their internet connectivity concern may have a role in determining their quality of life as they may choose to live away from home.
We can observe the Brooklyn borough has wide variance in the internet connectivity spread and broadband rating in neighborhoods, however Manhattan on the other end has pretty much better access and connectivity due to more activity and internet dependent businesses that prevail in the area.The Staten island has an average NTA rating of 1.8 which is less than average of other boroughs like the Queens and Manhattan but far better than the Bronx area.


```{r}
# Borough wise Household Distribution
bhd <- ggplot(data, aes(x=Borough, y=Total.Number.of.Households)) +
   geom_boxplot() + facet_wrap(~ plurality_racial_group) +
   theme_economist() + 
   scale_color_economist() +
   theme(axis.title = element_text(size = 7),
        axis.text = element_text(size = 7))

bhd
```


```{r}
pcolors <- wsj_pal(palette = "colors6")
freq_count <- data %>%
  group_by(Borough,plurality_racial_group) %>%
  summarize(Freq = n())

# Basic Mosaic Plot of Racial groups residing in different boroughs
fig_mos <- vcd::mosaic( plurality_racial_group ~ Borough,data = freq_count,
             set_labels=list(plurality_racial_group = c("W_e","H/L","A_n","B/A_n"),
                             highlighting_fill = pcolors,
                             Borough = c("B","M","Q","SI","Bx")),direction = c("v","h"))

fig_mos

```

```{r}
# Enhanced Mosaic Plot of Racial groups residing in different boroughs
cex.axis = 0.5
adv_mos <- mosaicplot(data$Borough ~ data$plurality_racial_group, 
           main = "Mosaic Distribution of Racial Groups",
           sub = "",
           ylab = "Plurality Racial Groups",
           xlab = "Boroughs",
           las = 1,
           border = "chocolate",
           cex.axis = 0.5,
           shade = TRUE)

adv_mos
```

```{r}
# Democratized Internet Access Spread
dias <- ggplot(data, aes(Home.Broadband.Adoption..,Total.Number.of.Households)) +
  geom_point(aes(color = plurality_racial_group)) +
  theme_grey(10) +
  facet_grid(~Borough) +
  theme(strip.text = element_text(size = 10, color = "blue"),legend.position = "bottom") +
  xlab("Broadband Adoption %") +
  ylab("Number of Households in various neighborhoods") +
  ggtitle("Check for Democratized Internet Access Spread") +
  theme_wsj(base_size = 7,) +
  scale_colour_wsj("colors6") +
  theme(axis.title=element_text(size=7))

dias
```

```{r}
# Home Internet Users Lifestyle
wsj_plot <- ggplot(data, aes(fill=Borough, y=Home.Broadband.Adoption.., x=Median.House.gross.rent..in...)) +
    geom_line(aes(color=Borough), alpha=.5, size =2) +
    ggtitle("Home Internet Users Lifestyle") +
    ylab("Percentage of Home Broadband Users (%) ") +
    xlab("House Gross Rent (in $)") +
    theme_wsj(base_size = 10,) +
    scale_colour_wsj("colors6") +
    theme(axis.title=element_text(size=9))

wsj_plot

```

```{r}

# Broadband Ratings in HCOL & LCOL
wsj_plot2 <- ggplot(data, aes(fill=Borough, x=Residential.Broadband.Choice.Average.by.NTA, y=Median.House.value..in...)) +
    geom_point(aes(color=Borough), alpha=.5, size =7) +
    ggtitle("Broadband Ratings in HCOL & LCOL") +
    xlab("Broadband Rating by NTA ") +
    ylab("House Value (in $)") +
    theme_wsj(base_size = 9,) +
    scale_colour_wsj("colors6") +
    theme(axis.title=element_text(size=9))

wsj_plot2

```


```{r}

# Parallel Coordinates Plot of Variables
ppcoord_plot <- ggparcoord(data, columns = c(4,7,6,8), alphaLines = 0.5,scale = "uniminmax", splineFactor = 10, showPoints = TRUE) +
  theme(legend.position = "none",plot.title = element_text(hjust = 0.2)) +
  scale_color_manual(values = c("grey70")) +
  ggtitle("Parallel plot of different variables for Internet Households") +
  geom_vline(xintercept = 1:4, color = "black") +
  theme(axis.text.x = element_text(angle=10))

ppcoord_plot
```


```{r}
data = read.csv(file='data/clean/combined_dataset_no_weird.csv')

data_snap <- select(data, c('Borough',
                          'Neighborhood.Name',
                          'Total.Population',
                          'Total.Number.of.Households',
                          'Per.Capita.Income..in...',
                          'Home.Broadband.Adoption..', 
                          'Residential.Broadband.Choice.Average.by.NTA',
                          'Mobile.Dependent.Households..Percentage.of.Households.' ,
                          'Public.Wi.Fi.in.NYC.Count', 
                          'Mobile.Broadband.Adoption..',
                          'English.only.language..',
                          'Language.other.than.English..',
                          'Native.born.in.US..',
                          'Foreign.born..',
                          'Completed.Bachelors.degree.or.higher..',
                          'Median.House.gross.rent..in...',
                          'Median.House.value..in...', 
                          'Owner.occupied.Housing.unit..',
                          'Total.occupied.Housing.unit..',
                          'Renter.occupied.Housing.unit..',
                          'Work.from.Home...Capable',
                          'Work.from.Home...Incapable',
                          'plurality_racial_group'
                          ))
data_snap$Per.Capita.Income..in... <- data_snap$Per.Capita.Income..in.../1000
data_snap$Mobile.Dependent.Households..Percentage.of.Households. <- data_snap$Mobile.Dependent.Households..Percentage.of.Households. * 100
data_snap$Mobile.Broadband.Adoption.. <- data_snap$Mobile.Broadband.Adoption.. * 100
data_snap$Home.Broadband.Adoption.. <- data_snap$Home.Broadband.Adoption.. * 100

```

```{r}

## Do the people in NYC who we are living in rented stays have access to better internet facilities?

# Internet Access Ratings around Rented Stays
iar <- ggplot(data, aes(fill=Borough, x=Residential.Broadband.Choice.Average.by.NTA, y=Renter.occupied.Housing.unit..)) +
    geom_line(aes(color=Borough), alpha=.5, size =8) +
    ggtitle("Internet Access Ratings around Rented Stays") +
    xlab("Region Broadband Rating by NTA") +
    ylab("Rented Housing Units in %") +
    theme_economist() + 
    scale_color_economist() +
    theme(axis.title = element_text(size = 5),
    axis.text = element_text(size = 5))

iar
```
Above plot analyses the broadband effectiveness in and around rented stays. Students, employed or unemployed people need to ensure the rent they pay give them the best facilities that's available in the region. As most of the people are immigrants, their internet connectivity concern may have a role in determining their quality of life as they may choose to live away from home.
We can observe the Brooklyn borough has wide variance in the internet connectivity spread and broadband rating in neighborhoods, however Manhattan on the other end has pretty much better access and connectivity due to more activity and internet dependent businesses that prevail in the area.The Staten island has an average NTA rating of 1.8 which is less than average of other boroughs like the Queens and Manhattan but far better than the Bronx area.


```{r}
# Borough wise Household Distribution
bhd <- ggplot(data, aes(x=Borough, y=Total.Number.of.Households)) +
   geom_boxplot() + facet_wrap(~ plurality_racial_group) +
   theme_economist() + 
   scale_color_economist() +
   theme(axis.title = element_text(size = 7),
        axis.text = element_text(size = 7))

bhd
```


```{r}
pcolors <- wsj_pal(palette = "colors6")
freq_count <- data %>%
  group_by(Borough,plurality_racial_group) %>%
  summarize(Freq = n())

# Basic Mosaic Plot of Racial groups residing in different boroughs
fig_mos <- vcd::mosaic( plurality_racial_group ~ Borough,data = freq_count,
             set_labels=list(plurality_racial_group = c("W_e","H/L","A_n","B/A_n"),
                             highlighting_fill = pcolors,
                             Borough = c("B","M","Q","SI","Bx")),direction = c("v","h"))

fig_mos

```

```{r}
# Enhanced Mosaic Plot of Racial groups residing in different boroughs
cex.axis = 0.5
adv_mos <- mosaicplot(data$Borough ~ data$plurality_racial_group, 
           main = "Mosaic Distribution of Racial Groups",
           sub = "",
           ylab = "Plurality Racial Groups",
           xlab = "Boroughs",
           las = 1,
           border = "chocolate",
           cex.axis = 0.5,
           shade = TRUE)

adv_mos
```

```{r}
# Democratized Internet Access Spread
dias <- ggplot(data, aes(Home.Broadband.Adoption..,Total.Number.of.Households)) +
  geom_point(aes(color = plurality_racial_group)) +
  theme_grey(10) +
  facet_grid(~Borough) +
  theme(strip.text = element_text(size = 10, color = "blue"),legend.position = "bottom") +
  xlab("Broadband Adoption %") +
  ylab("Number of Households in various neighborhoods") +
  ggtitle("Check for Democratized Internet Access Spread") +
  theme_wsj(base_size = 7,) +
  scale_colour_wsj("colors6") +
  theme(axis.title=element_text(size=7))

dias
```

```{r}
# Home Internet Users Lifestyle
wsj_plot <- ggplot(data, aes(fill=Borough, y=Home.Broadband.Adoption.., x=Median.House.gross.rent..in...)) +
    geom_line(aes(color=Borough), alpha=.5, size =2) +
    ggtitle("Home Internet Users Lifestyle") +
    ylab("Percentage of Home Broadband Users (%) ") +
    xlab("House Gross Rent (in $)") +
    theme_wsj(base_size = 10,) +
    scale_colour_wsj("colors6") +
    theme(axis.title=element_text(size=9))

wsj_plot

```

```{r}

# Broadband Ratings in HCOL & LCOL
wsj_plot2 <- ggplot(data, aes(fill=Borough, x=Residential.Broadband.Choice.Average.by.NTA, y=Median.House.value..in...)) +
    geom_point(aes(color=Borough), alpha=.5, size =7) +
    ggtitle("Broadband Ratings in HCOL & LCOL") +
    xlab("Broadband Rating by NTA ") +
    ylab("House Value (in $)") +
    theme_wsj(base_size = 9,) +
    scale_colour_wsj("colors6") +
    theme(axis.title=element_text(size=9))

wsj_plot2

```


```{r}

# Parallel Coordinates Plot of Variables
ppcoord_plot <- ggparcoord(data, columns = c(4,7,6,8), alphaLines = 0.5,scale = "uniminmax", splineFactor = 10, showPoints = TRUE) +
  theme(legend.position = "none",plot.title = element_text(hjust = 0.2)) +
  scale_color_manual(values = c("grey70")) +
  ggtitle("Parallel plot of different variables for Internet Households") +
  geom_vline(xintercept = 1:4, color = "black") +
  theme(axis.text.x = element_text(angle=10))

ppcoord_plot
```


Sources:
https://www.census.gov/topics/income-poverty/poverty/guidance/poverty-measures.html#:~:text=Step%201%3A%20Determine%20the%20family's,threshold%20(below)%20is%20%2433%2C148.


