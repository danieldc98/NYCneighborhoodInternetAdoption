# Results

```{r, echo=FALSE, include=FALSE}
# libraries
library(dplyr)
library(leaflet)
library(sp)
library(ggmap)
library(maptools)
library(broom)
library(httr)
library(rgdal)
library(ggplot2)
library(tigris)
library(RColorBrewer)
library(ggpubr)
# import data
data = read.csv(file='data/clean/combined_dataset.csv')
```
Home Internet Adoption Map:
```{r, echo=FALSE}
# import map data
nyc_neighborhoods <- readOGR('data/map/NTA_map.geojson')

current <- select(data, c('Borough', 'Neighborhood.Name', 'Home.Broadband.Adoption..'))
names(current)[1] <- 'borough'
names(current)[2] <- 'neighborhood'
names(current)[3] <- 'points'

current$borough_num <- unclass(current$borough)
current$opacity_lvl <- current$points
current$opacity_lvl <- current$opacity_lvl^3

map_data <- geo_join(nyc_neighborhoods, current, "ntaname", "neighborhood")

pal <- colorFactor(palette = 'Set1',
                    unique(map_data@data$boroname))

leaflet(map_data) %>%
  addTiles() %>%
  addPolygons(popup = paste("Neighborhood:", map_data@data$ntaname, "<br>",
                            "Borough:", map_data@data$boroname, "<br>",
                            "Internet Adoption Rate:", paste(map_data@data$points*100, '%', sep=''), "<br>"),
              fillColor = ~pal(map_data@data$boroname),
              fillOpacity = map_data@data$points^3,
              highlightOptions = highlightOptions(weight = 3),
                                  color = "Black",
                                  weight = 1) %>%
  addProviderTiles("CartoDB.Positron") %>%
  addLegend("bottomright", pal = pal, values = ~map_data@data$boroname)
```


Income and Internet Trends:
```{r, echo=FALSE}
current <- select(data, c('Borough',
                          'Per.Capita.Income..in...',
                          'Home.Broadband.Adoption..', 
                          'Residential.Broadband.Choice.Average.by.NTA',
                          'Mobile.Dependent.Households..Percentage.of.Households.' ,
                          'Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in..',
                          'Public.Wi.Fi.in.NYC.Count', 
                          'Mobile.Broadband.Adoption..'))

current$Per.Capita.Income..in... <-
  current$Per.Capita.Income..in.../1000

current$Mobile.Dependent.Households..Percentage.of.Households. <-
  current$Mobile.Dependent.Households..Percentage.of.Households. * 100

current$Mobile.Broadband.Adoption.. <-
  current$Mobile.Broadband.Adoption.. * 100

current$Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in.. <-
  current$Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in.. * 100

current$Home.Broadband.Adoption.. <-
  current$Home.Broadband.Adoption.. * 100


plot1 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Home.Broadband.Adoption..)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black') +
  xlab('Income (in $1000s)') +
  ylab('% Internet Adoption') +
  theme(text = element_text(size = 10)) +
  theme_bw()
  
plot2 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Residential.Broadband.Choice.Average.by.NTA)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black') +
  xlab('Income (in $1000s)') +
  ylab('# of Carriers') +
  theme(text = element_text(size = 10)) +
  theme_bw()

plot3 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Mobile.Dependent.Households..Percentage.of.Households.)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black') +
  xlab('Income (in $1000s)') +
  ylab('% Mobile Dependent') +
  theme(text = element_text(size = 10)) +
  theme_bw()

plot4 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in..)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black')  +
  xlab('Income (in $1000s)') +
  ylab('% High Speed Internet') +
  theme(text = element_text(size = 10)) +
  theme_bw()

plot5 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Public.Wi.Fi.in.NYC.Count)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black') +
  xlab('Income (in $1000s)') +
  ylab('Public WiFi Count') +
  theme(text = element_text(size = 10)) +
  theme_bw()

plot6 <- ggplot(current, aes(x=Per.Capita.Income..in..., y=Mobile.Broadband.Adoption..)) +
  geom_point(aes(color=Borough), alpha=.6, size=1) +
  geom_smooth(method='glm', size=.5, se=FALSE, color='black') +
  xlab('Income (in $1000s)') +
  ylab('% Mobile Internt Adoption') +
  theme(text = element_text(size = 10)) +
  theme_bw()

figure <- ggarrange(plot1, plot2, plot3, plot4, plot5, plot6, ncol=3, nrow=2, common.legend = TRUE, legend="bottom")

annotate_figure(figure,
                top = text_grob("Income and Internet Trends", size=20, face = "bold"))
```
In the above graphs we can see a comparison of income levels (by borough) and several internet availability measures. The black line on each graph represents the trend between income and the respective measure of internet. The colors represent the boroughs and each dot is a neighborhood within the borough. 

As we can see from the data, Manhattan seems to be the borough with the highest income. The green dots tend to be further right and away from the other boroughs demonstrating that trend. The rest of the boroughs are relatively close together regarding their income. We see this in looking at the clusters in each graph.

Now, looking at internet trends with regards to internet availability, there are some significant patterns to be aware of. First of all, when looking at the black trend line we can see that they are all positive trends except the top right graph representing mobile dependent households. For the other five comparisons, this signifies that higher incomes are correlated with better internet. Whether it be more public Wi-Fi hot-spots, faster internet, more selection with internet providers, or higher mobile and household internet adoption. As for the top right graph showing the negative trend. This is because mobile dependency is the inverse of better internet coverage. If more households are mobile dpendent it means they do not have internet in their and therefore a lower internet adoption rate. 

Looking at these trends we can see that internet adoption is positively correlated to income level. As the higher the income the more available internet is in each neighborhood.

Significant Trend in The Bronx:
```{r, echo=FALSE}
current = select(data, c('Borough', 'Families.below.poverty.level..', 'Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in..'))

current$Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in.. <-
  current$Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in.. * 100
ggplot(current, aes(x=Families.below.poverty.level.., y=Blocks.with.ISP.Reported.Speed.Availability.of...900.Mbps.in.., col=Borough)) +
  geom_point(size=2) +
  xlab('Families Below Poverty Line') +
  ylab('% Internet availability > 900 Mbps') +
  ggtitle('Poverty Level and Fast Speed Internet') +
  theme_bw()
```
This graph represents families below the poverty line in each neighborhood compared to high speed internet availability. The poverty line in the United States is annual income below $33,000. As for the y-axis variable, this represents the percentage of blocks in a neighborhood that have access to internet speeds of 900 Mbps or higher. This high speed internet is crucial for businesses operating several internt-dependent pieces of technology at once as well as any household with a large number of connected devices. 

As we can see from the chart The Bronx seems to be isolated from the other boroughs. No neighborhood in The Bronx has complete access to internet speeds greater than 900 Mbps. Also, we see neighborhoods int he Bronx being further right on the graph than neighborhoods in other boroughs. This signifies more families below the poverty line compared to the other boroughs. These two factors again reinforce the idea that economic status and internt adoption are correlated.